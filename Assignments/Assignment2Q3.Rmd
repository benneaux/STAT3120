---
title: "Assignment2Q3"
author: "Benjamin G. Moran; <right> c3076448@uon.edu.au </right>"
date: "22nd August 2016"
output:
  html_document:
    graphics: yes
    highlight: pygments
    includes:
      before_body: eqnnumber.js
    mathjax: default
    smart: yes
subtitle: <center> Semester 2, 2016 </center>
---

```{r setup, include=FALSE}
require(tufte)
require(knitr)
opts_chunk$set(cache = FALSE)
opts_chunk$set(fig.align = 'center', fig.height = 3.5, fig.width = 3.5, collapse = TRUE, highlight = TRUE)
```
##Question 3	[Total: 20 marks]

Consider the example on corn yields but with an extended data set, with sample sizes, sample means and sample variances as given below. We have five different corn growers giving individual yields for a particular new type of genetically engineered corn that has three seasons per year. The corn is distributed by a research station to the growers. Growers give yields for the most recent seasons in tons/hectare. Summary statistics for the data are given below.

```{r Q3 table, echo=FALSE}
row.symbols = c(ni='n\U1D62', ybar='y\u0305\U1D62', sigmaSq="s\U00B2\U1D62")
q3.table = matrix(c(16, 15.3, 8.2, 19, 16.2, 12.3, 14, 16.4, 7.9, 12, 13.2, 5.2, 8, 13.5, 6.2), 3, 5)
colnames(q3.table) = c("1", "2", "3","4", "5")
row.labels = c(row.symbols['ni'], row.symbols['ybar'], row.symbols['sigmaSq'])
rownames(q3.table) = row.labels
kable(q3.table, align = rep(c("c","c"), dim(q3.table)[2] + 1), caption = "Corn Yield Data by Grower", escape = TRUE)
```

```{r Q3 Data, echo = FALSE}

n <- c(16, 19, 14, 12, 8)
y.bar <- c(15.3, 16.2, 16.4, 13.2, 13.5)
sig2 <- c(8.2, 12.3, 7.9, 5.2, 6.2)

```

```{r Q3 Ex.Code}
y2 <- 16.2
sig.y2 <- 12.3
y4 <- 13.2
sig.y4 <- 5.2
x2 <- seq(5,25,by=0.001)
mu <- 16.11
tau <- 1.82
px2 <- -(x2 - mu)^2/(2*tau^2) -(3/2)*log(1 + (3*(x2-y2)^2)/(2*sig.y2))
plot(x2,exp(px2),type='l',col=2)
x4=seq(5,25,by=0.001)
px4=-(x4-mu)^2/(2*tau^2)-3/2*log(1+(3*(x4-y4)^2)/(2*sig.y4))
lines(x4,exp(px4),col=4)
px2=exp(px2)/sum(exp(px2))
px4=exp(px4)/sum(exp(px4))
cdf2 <- cumsum(px2)
cdf4 <- cumsum(px4)

plot(x2,cdf2,type='l',col=2)
lines(x4,cdf4, type = 'l', col = 4)

```

(a)	By adapting code from the week 7 lecture, fit a hierarchical Normal model to this data, using the Empirical Bayes approach. Provide estimates and inference for each unknown true grower mean yield, including a plot showing all estimated posterior densities, one for each unknown mean.	[7 marks]

(b) Plot the estimated parent density for the five grower means. At what percentile of this distribution does of each growerâ€™s estimated posterior mean yield lie? Do they all fit in with the prior distribution? [2 marks]

(c) What is the posterior probability that each of the five growers has the largest mean yield? What is your conclusion in this case? [2 marks]

(d) What is the posterior probability that, for each pair of growers (grower i and i+k), the mean yield for grower(i) exceeds the mean yield for grower (i+k)? [2 marks]
(e) What is the most likely ordering for the 5 mean grower yields in your MC sample? What are the 2nd, 3rd and 4th most likely orderings? [4 marks]

(f)	Based on (a)-(d), and any other evidence you can provide, where do you believe significant differences exist among the 5 grower means (if any)? [3 marks]

###End of Assignment 2